<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Letter Stacks — User Guide</title>
  <link rel="stylesheet" href="styles/base.css" />
  <link rel="stylesheet" href="styles/landing.css" />
</head>
<body class="landing">
  <div class="wrap">
    <header class="hero" aria-label="Letter Stacks — User Guide">
      <div class="actions" style="justify-content:flex-start">
        <a class="button secondary" href="index.html" title="Back to Home">← Back to Home</a>
      </div>
      <h1 class="title">User Guide</h1>
      <p class="tagline">How to play, levels, and tips.</p>
      <div class="pill" role="status"><strong>Beta:</strong> This is a beta build. Testing and feedback are appreciated.</div>
    </header>

    <!-- Goal & Basics -->
    <section class="howto" aria-label="Goal & Basics">
      <h2>Goal & Basics</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">1</div>
          <div><strong>Objective:</strong> Clear the entire board by submitting valid words until no tiles remain.</div>
        </div>
        <div class="step">
          <div class="ico">2</div>
          <div><strong>Select letters:</strong> Pick any tiles (no adjacency rule). Minimum word length is <strong>3</strong>.</div>
        </div>
        <div class="step">
          <div class="ico">3</div>
          <div><strong>Submit:</strong> Removes the <em>top</em> letter from each selected stack and returns those letters to the bag.</div>
        </div>
        <div class="step">
          <div class="ico">4</div>
          <div><strong>Optional lose:</strong> If any stack reaches the chosen threshold (5–10), the run ends.</div>
        </div>
      </div>
    </section>

    <!-- Spawning & Drop -->
    <section class="howto" aria-label="Spawning & Drop">
      <h2>Spawning & Drop</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">1</div>
          <div>New letters spawn on a timer. The next‑spawn countdown also appears inside the <strong>Drop (▼)</strong> button.</div>
        </div>
        <div class="step">
          <div class="ico">2</div>
          <div>Tiles that will receive the next spawn display an on‑tile <strong>circular countdown clock</strong> (a rotating hand with a trailing wedge).</div>
        </div>
        <div class="step">
          <div class="ico">3</div>
          <div><strong>Drop (▼):</strong> Instantly spawn exactly one letter and reset the timer. Repeat to drop more, one per click.</div>
        </div>
        <div class="step">
          <div class="ico">4</div>
          <div><strong>Targeting:</strong> Default: spawns fill <em>empty tiles first</em> (random among empties), then randomly anywhere. <strong>Extreme Level (26):</strong> of the 6 targets each cycle, 2 go to the tallest stack(s) (random among ties); the remaining 4 are random anywhere.</div>
        </div>
        <div class="step">
          <div class="ico">5</div>
          <div><strong>Fill indicator:</strong> each tile shows a bottom‑up green <strong>fill bar</strong> proportional to its stack relative to the threshold.</div>
        </div>
      </div>
    </section>

    <!-- Levels & Tempo -->
    <section class="howto" aria-label="Levels & Tempo">
      <h2>Levels & Tempo</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">A</div>
          <div>
            <strong>Level (1–26):</strong> sets base cadence and spawn quantity:
            <ul>
              <li><strong>Levels 1–6:</strong> 1 tile every 10→5s (higher level = faster)</li>
              <li><strong>Levels 7–12:</strong> 2 tiles every 10→5s</li>
              <li><strong>Levels 13–18:</strong> 3 tiles every 10→5s</li>
              <li><strong>Level 19:</strong> 3 tiles every 4s</li>
              <li><strong>Level 20:</strong> 4 tiles every 10s</li>
              <li><strong>Levels 21–24:</strong> 4 tiles every 8→5s</li>
              <li><strong>Level 25:</strong> 5 tiles every 6s</li>
              <li><strong>Level 26 (Extreme):</strong> 6 tiles every 6s (fixed tempo)</li>
            </ul>
          </div>
        </div>
        <div class="step">
          <div class="ico">B</div>
          <div>
            <strong>Tempo adapts to word length (simplified):</strong>
            <ul>
              <li><strong>3 letters:</strong> next drop is faster by 3 seconds from your level’s base timing (then returns to normal)</li>
              <li><strong>4 letters:</strong> no change (stays at the level’s base timing)</li>
              <li><strong>5+ letters:</strong> next drop is slower by 3 seconds from your level’s base timing (then returns to normal)</li>
            </ul>
            <div class="note">If 12 seconds pass without playing a word, drops run at about 50% of the base timing (rounded down) until you play a word. Extreme Level (26) ignores adaptive tempo and idle acceleration — it always runs 6 tiles every 6s.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Scoreboard -->
    <section class="howto" aria-label="Scoreboard">
      <h2>Scoreboard</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">✓</div>
          <div>Your completion time is saved locally per level (no backend). Open <strong>☰ Menu → Scoreboard</strong> to view, filter by level, and share.</div>
        </div>
        <div class="step">
          <div class="ico">✓</div>
          <div>Sharing uses your device’s share sheet when available; otherwise it falls back to clipboard copy and mailto links.</div>
        </div>
      </div>
    </section>

    <!-- Settings & Controls -->
    <section class="howto" aria-label="Settings & Controls">
      <h2>Settings & Controls</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">1</div>
          <div><strong>Board:</strong> fixed <strong>5×6</strong>. <strong>Lose at Stack:</strong> choose 5–10. Countdown also appears inside the Drop (▼) button.</div>
        </div>
        <div class="step">
          <div class="ico">2</div>
          <div><strong>Controls:</strong> Tap tiles to toggle selection. <strong>Enter</strong> submit • <strong>Escape</strong> clear • <strong>▼ Drop</strong> spawn one • <strong>☰ Menu</strong> Settings / Scoreboard / Reset / Home.</div>
        </div>
        <div class="step">
          <div class="ico">3</div>
          <div><strong>Dictionary:</strong> words are validated via a local offline dictionary bundled with the game (<code>data/words.json</code>) and cached by the Service Worker. Submissions require membership in this dictionary.</div>
        </div>
        <div class="step">
          <div class="ico">4</div>
          <div><strong>Vowel meter:</strong> the top‑left header shows <strong>“V: NN%”</strong>, the percentage of visible vowels on the board (top letters only). It updates as tiles land and after submissions.</div>
        </div>
      </div>
    </section>

    <!-- Tips -->
    <section class="howto" aria-label="Tips">
      <h2>Tips</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">✓</div>
          <div>Use longer words when the board is crowded to slow spawns and regain control.</div>
        </div>
        <div class="step">
          <div class="ico">✓</div>
          <div>Watch tiles with the circular countdown to anticipate which stacks will grow next.</div>
        </div>
        <div class="step">
          <div class="ico">✓</div>
          <div>Use <strong>Drop (▼)</strong> tactically to adjust the cadence on your terms.</div>
        </div>
      </div>
    </section>

    <section class="howto" aria-label="Deep Dive: How letters are chosen">
      <h2>Deep Dive: How letters are chosen</h2>
      <div class="steps">
        <div class="step">
          <div class="ico">1</div>
          <div><strong>Shuffled bag:</strong> The game uses a shuffled “bag” of letters (like Scrabble). When the bag empties, it refills automatically. Letters you remove are returned and re‑shuffled for variety.</div>
        </div>
        <div class="step">
          <div class="ico">2</div>
          <div><strong>Decided at the moment:</strong> A letter is chosen right when it appears (timer spawn or when you press Drop), not earlier. This avoids pre‑batched streaks.</div>
        </div>
        <div class="step">
          <div class="ico">3</div>
          <div><strong>Gentle balancing:</strong> If the visible top letters are heavy on vowels (about 35%+), the game prefers to spawn a consonant. If they’re heavy on consonants (about 75% consonants / 25% vowels), it prefers a vowel. It looks at a small slice of the bag for a good match; if none is found quickly, it simply uses the next natural letter.</div>
        </div>
        <div class="step">
          <div class="ico">4</div>
          <div><strong>Vowel meter:</strong> The top‑left header shows “V: NN%”, the percentage of visible vowels (tops only). It updates as tiles land and after submissions.</div>
        </div>
      </div>
    </section>

    <div class="actions" style="margin-top:16px; justify-content:center">
      <a class="button primary" href="index.html" title="Back to Home">Back to Home</a>
      <a class="button" href="game.html?showSettings=1" title="Start Game">Start Game</a>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
